# 1. 데이터 추가, 삭제, 갱신, 데이터 정합성

## 1-1. INSERT, 행 추가하기

테이블에 행을 추가할 때는 해당 테이블 구조에 맞게 데이터를 넣어야한다는 것에 주의해야하며, 아래와 같이 코드를 작성해 테이블에 데이터를 추가할 수 있다.

- INSERT 예시
	```mysql
	INSERT INTO table_name(column1, column2, column3, ... ) VALUES(value1, value2, value3);
	```

## 1-2. DELETE, 행 삭제하기.

테이블에서 데이터를 삭제할 때도 행 단위로 삭제할 수 있으며 특정 테이블을 삭제할 때 특정 행의 조건을 설정할 수도 있으며, 아래와 같이 코드를 작성해서 데이터를 삭제할 수 있다.

- DELETE 예시
	```mysql
	DELETE FROM table_name 
	WHERE some_column = some_value;
	```

## 1-3. UPDATE, 데이터 갱신하기

데이터베이스 테이블에 추가된 데이터는 처음 추가된 상태 그대로 존재할 수 있지만 자주 업데이트될 수도 있다. 데이터를 업데이트하고 싶은 경우에 아래와 같이 코드를 작성하여 데이터를 업데이트할 수 있다.

- UPDATE 예시
	```mysql
	UPDATE table_name // 업데이트할 테이블 설정
	SET column_name = "new value" // 데이터 변경
	WHERE condition; // 조건 설정
	```


## 1-4. Procedure

**매크로처럼 반복되는 내용을 하나의 단위로 생성할 수 있는데, 이렇게 생성된 단위를 Procedure라고 한다.** 

| 상품 번호 | 원가 | 판매일자 | 취소 여부 |
| --------- | ---- | -------- | --------- |
| 13252     | 100  | 2019.1.1 | N         |
| 13252     | 100  | 2019.1.2 | Y         |
| 36362     | 300  | 2019.1.1 | N         |

위와 같은 product 테이블에 데이터가 존재한다고 했을 때, 아래의 조건에 따라 데이터를 변경하도록 SQl문을 작성해보자.

- 취소가 "Y"인 데이터의 매출액에 -1을 곱해 음수로 변경하기
	```mysql
	UPDATE product
	SET 원가 = (-1) * 원가
	WHERE 취소여부 = "Y";
	```


- 어제 날짜의 데이터만 취소가 "Y"인 데이터의 매출액에 -1을 곱해 음수로 변경하기
	```mysql
	UPDATE product
	SET 원가 = (-1) * 원가
	WHERE 취소여부 = "Y"
	AND 판매 일자 = CURDATE() - 1;
	```


## 1-5. View

뷰란 가상의 테이블로 사용자 입장에서는 테이블과 동일하게 보이지만, 실제로 데이터를 가지고 있지는 않으며 실제 테이블에 링크된 개념이라고 생각하면 된다. 특정 데이터들을 낮은 접근 권한을 가지는 사용자에게 보여주고 싶을 때 사용한다.

- 특정 사용자에게 보여주고 싶은 데이터
	```mysql
	SELECT *
	FROM product
	WHERE 취소여부 = "Y";
	```

- 위의 데이터를 뷰로 만들기
	```mysql
	CREATE VIEW DB.cancel_prodno
	AS SELECT *
	FROM product
	WHERE 취소여부 = "Y";
	```

위의 SQL문으로 생성된 뷰는 아래와 같이 테이블과 동일한 방식으로 사용 가능하다.

- 뷰 안의 데이터 조회하기
	```mysql
	SELECT * 
	FROM DB.cancel_prodno;
	```


## 1-6. 데이터 정합성

데이터베이스 안의 데이터는 정합성을 가지는 것이 중요하다. 데이터 정합성이란 데이터들의 값이 일치함을 의미한다. 예를들어 매출 테이블에서 연도별 매출을 계산한다는 것은 전체 매출을 연도별로 나눈다는 것을 의미하고 반대로 연도별로 나눈 매출의 합은 전체 매출과 같아야 한다.

서비스를 분석할 때, MECE하게 분석한다는 얘기가 있다. MECE는 Mutually Exclusive Collectively Exhaustive의 줄임 말로 서로 중복 없이 그리고 누락된 것 없이 분석한다는 뜻으로 만약 서비스 매출을 고객 세그먼트로 나눠 분석한다면 각 세그먼트 간의 교집합이 발생하지 않도록 구분해 분석하는 것이 좋다.

<br>

> - MECE란 ?
> MECE란 각 항목들이 상호 배타적이면서 모였을 때는 완전하게 합쳐지는 것을 의미한다.
> 	
> 	대부분의 분석은 전체에서 부분으로 나누어 살펴보게되는데 이때 부분의 합은 전체의 합과 항상 일치해야 한다. 하지만 분석하다보면 부분의 합이 전체의 합보다 크거나 작은 경우가 빈번히 발성하는데 데이터의 신뢰성을 확보하려면 부분이 합이 전체의 합과 일치하는지 항상 확인하면서 분석을 진행해야 한다.






