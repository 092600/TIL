ㅈ# 예외처리

- 예외처리 주의사항
	- try - catch 구문 사용 후 아무런 처리도 하지 않는 것
	- 무의미한 throws (메서드 밖으로 예외를 던져버리는 것)

Error란 java.lang.Error 클래스의 서브 클래스들로 비정상적인 상황이 발생한 경우에 발생한다. 주로 VM 에서 발생시키는 것으로 애플리케이션에서 잡으려고 하면 안된다. Error의 예로는 OutOfMemoryError나 ThreadDeath 가 있다.

### 예외(Exception) 이란 ?

예외(Exception)란 java.lang.Exception 클래스와 서브클래스로 정의되는 예외들은 에러와 달리 애플리케이션의 코드 작업 중 예외상황이 발생한 경우에 사용된다.

그리고 에외는 체크 예외와 언체크 예외로 구분되는데 체크 예외는 Exception 클래스의 서브클래스이면서 RuntimeException 클래스를 상속하지 않는 것들이고, 언체크 예외는 RuntimeException을 상속한 클래스들을 말한다.

- 체크 예외 : Exception 클래스의 서브클래스이면서 RuntimeException을 상속하지 않는 예외
	- 일반적으로 체크 예외는 예외가 발생한 메서드 외부로 예외를 던지는 것은 큰 의미가 없으며 메서드 선언부만 더럽게 만든다.
- 언체크 예외 / 런타임 예외 : RuntimeException을 상속하는 예외
	- 일반적으로 언체크 예외는 예외를 잡거나 던지는 것이 의미가 없다. (예외를 잡더라도 복구할 방법이 없기 때문에 .. )

## 예외를 처리하는 방법

1. try - catch 문을 이용하여 메서드 내에서 예외를 처리하는 방법
	```java
	public void methodA() {
		try {
			// 실행 로직
		} catch (IOException e) {
			// 로직 실행 중 발생한 예외처리
		}
	}
	```
2.  예외가 발생한 메서드 내에서 바로 예외를 처리하지 않고 메서드 외부로 예외를 던지는 방법
	```java
	public void methodA() throw IOException {
		// 실행 로직 
	}
	```



예외로 인해 기존의 작업을 진행하는 것이 어렵다면 다른 작업으로 유도하는 것이 좋다. 예를들어 파일을 읽을 때 발생하는 예외인 IOException이 발생한 경우 다른 파일을 이용하도록 유도해주어야 하는데 여기서 중요한 것은 **예외가 발생하더라도 애플리케이션은 설계된 흐름대로 진행되어야 한다는 것이다.**

## 예외 전환

예외 전환이란 발생한 예외를 그대로 던지는 것만으로는 부족할 경우 발생한 예외의 의미를 좀 더 분명하게 해줄 수 있는 예외로 바꿔주는 것을 말한다. 예외를 전환하는 방법으로는 예외의 의미를 좀 더 분명하게 할 수 있도록 예외를 바꾸어 외부로 던지는 방법 혹은 예외를 포장하는 방법이 존재한다.

### 예외 전환하기

예외를 전환하는 것은 예를 들어 같은 DB에 같은 ID 값을 넣으려하여 SQLException이 발생하였을 때  SQLException을 외부로 그대로 던지는 것보다 SQLException을 DuplicationException으로 포장하여 외부로 던지는 것으로 예외의 의미를 분명하게 해줄 수 있다.

- 예외 전환 예시
	```java
	public void methodA() {
		try {
			...
		} catch (SQLException e){
			throw DuplicationException(e);
		}
	}
	```
	

### 예외 포장하기

예외를 포장하는 방법은 새로운 예외를 만들고 원인이 되는 예외를 내부에 담아서 던진다는 점에서 예외 전환과 비슷하지만 예외의 의미를 명확하게 해주기 위한 것이 아니라 체크 예외를 언체크 예외인 런타임 예외로 바꾸는 경우에 사용한다.

## 예외처리 전략

1. 발생한 예외를 처리할 수 있을 경우 예외를 처리한다. (체크 예외)
2. "발생한 예외가 처리할 수 없다"라는 판단이 선 경우 런타임 예외를 발생시킨다.  (언체크 예외)

예외 처리가 꼭 필요한 경우에는 정상적인 경우와 비정상적인 경우에 다른 리턴 값을 반환하도록 하여 리턴 값에 따라 다른 처리 로직을 실행하도록 하거나 정상적인 흐름을 따르는 코드는 그대로 두고 예외가 발생한 경우에는 비즈니스적 의미를 지닌 예외를 던지는 방법을 사용하도록 하자. **또한 이렇게 발생한 예외를 처리해야 하는 경우에는 체크 예외를 사용해야한다.**

# 정리

1. 예외를 처리하고 싶은 경우 예외를 체크 예외로 만들고, try - catch 문을 통해 예외를 잡더라도 딱히 할 게 없을 경우 언체크 예외로 만들자.
2. 무분별한 throws 혹은 예외를 잡고서도 아무런 조치를 취하지 않는 것은 자제하자.
3. 발생한 예외의 의미를 좀 더 분명하게 하고자 하는 경우에 예외를 전환하는 것이 좋다.
4. 예외를 포장하는 것은 예외를 전환하는 것과 방법은 비슷하지만 예외를 포장한다는 것은 체크 예외를 언체크 예외로 바꾸는 것이라는 것에 초점을 맞추자 
5. SQLException은 DB에 종속적이다.
6. DB에 종속적이지 않은 JPA, 하이버네이트 등은 DB에 종속적인 SQLException 대신 언체크 예외를 발생시킨다.
7. 언체크 예외를 발생시키면 interface를 사용할 때 메서드 선언부에 throws 를 사용하지 않아도 된다.
8. 추상화된 런타임 예외 계층은 기술이 DB에 독립적으로 작성될 수 있도록 도와준다.
